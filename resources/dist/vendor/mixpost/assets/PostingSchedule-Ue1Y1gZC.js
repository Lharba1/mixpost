import{r as z,T as L,h as W,c as i,o as l,a as t,b as r,u as _,Z as E,w as o,F as y,e as x,t as c,f as v,n as Z,d,P as G,U as A,g as H,k as J,N as h}from"./app-NbvkMcfZ.js";import{_ as K}from"./PageHeader-BhhjZcSE.js";import{_ as q}from"./Panel-D5VYsTXZ.js";import{_ as V}from"./PrimaryButton-DAmLOIwA.js";import{_ as X}from"./Input-DJbJN9rY.js";import{_ as Y}from"./Select-BADK_Zwt.js";import{_ as P}from"./Label-CUxHZ7tx.js";import{_ as N}from"./Error-W4wOCD_8.js";import{a as ee}from"./DialogModal-CwSKc9Cx.js";import{_ as te}from"./Flex-DBeXgXV-.js";import{_ as I}from"./Badge-L-bhs8IU.js";import{T as Q}from"./Trash-BrR0HZ8z.js";import{A as se}from"./ArrowPath-Bx9zdWak.js";import"./PureButton-DVwH8TWV.js";const oe={class:"row-py mb-2xl w-full mx-auto"},re={class:"row-px"},le={class:"grid grid-cols-7 gap-2"},ae={class:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2 text-center"},ie={class:"space-y-1 min-h-[60px]"},de=["onClick"],ne=["onClick"],ue={key:0,class:"text-xs text-gray-400 text-center py-2"},me={key:0,class:"space-y-3"},ce={class:"text-2xl font-bold text-gray-300 dark:text-gray-600 w-8"},_e={class:"flex-1 min-w-0"},fe={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},pe={class:"text-xs text-gray-500 mt-1"},ye={key:0,class:"ml-2 text-gray-400"},ge={class:"flex gap-2"},xe=["onClick"],ve=["onClick"],he={key:1,class:"text-center py-8 text-gray-500"},ke={class:"space-y-4"},be=["value"],je={__name:"PostingSchedule",props:{schedule:{type:Object,required:!0},queue_items:{type:Array,default:()=>[]},days:{type:Object,required:!0}},setup(f){const p=f,k=z(!1),n=L({day_of_week:1,time:"09:00"}),B=()=>{n.reset(),k.value=!0},b=()=>{k.value=!1,n.reset()},F=()=>{n.post(route("mixpost.schedule.addTimeSlot"),{preserveScroll:!0,onSuccess:()=>{b()}})},j=a=>{confirm("Remove this time slot?")&&h.delete(route("mixpost.schedule.removeTimeSlot",{time:a}),{preserveScroll:!0})},R=a=>{h.put(route("mixpost.schedule.toggleTimeSlot",{time:a}),{},{preserveScroll:!0})},D=a=>{confirm("Remove this post from the queue?")&&h.delete(route("mixpost.schedule.removeFromQueue",{queueItem:a}),{preserveScroll:!0})},M=a=>{h.put(route("mixpost.schedule.retryQueueItem",{queueItem:a}),{},{preserveScroll:!0})},w=W(()=>{let a=[];p.schedule.times&&(Array.isArray(p.schedule.times)?a=p.schedule.times:Array.isArray(p.schedule.times.data)&&(a=p.schedule.times.data));const e={};for(const[s,u]of Object.entries(p.days))e[s]=a.filter(m=>m.day_of_week===parseInt(s));return e}),O=a=>({pending:"info",processing:"warning",published:"success",failed:"danger"})[a]||"default";return(a,e)=>(l(),i(y,null,[t(_(E),{title:"Posting Schedule"}),r("div",oe,[t(K,{title:"Posting Schedule"}),r("div",re,[t(q,null,{title:o(()=>e[2]||(e[2]=[d("Weekly Schedule")])),description:o(()=>e[3]||(e[3]=[d(" Set up recurring time slots for automatic post scheduling. ")])),action:o(()=>[t(V,{onClick:B,size:"sm"},{default:o(()=>[t(G,{class:"w-4 h-4 mr-1"}),e[4]||(e[4]=d(" Add Time Slot "))]),_:1,__:[4]})]),default:o(()=>[r("div",le,[(l(!0),i(y,null,x(f.days,(s,u)=>(l(),i("div",{key:u,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},[r("h4",ae,c(s.substring(0,3)),1),r("div",ie,[(l(!0),i(y,null,x(w.value[u],m=>(l(),i("div",{key:m.id,class:Z(["flex items-center justify-between p-1.5 bg-white dark:bg-gray-700 rounded text-xs",{"opacity-50":!m.is_active}])},[r("button",{onClick:g=>R(m.id),class:"font-medium text-gray-700 dark:text-gray-300 hover:text-primary-500"},c(m.formatted_time),9,de),r("button",{onClick:g=>j(m.id),class:"text-gray-400 hover:text-red-500"},[t(Q,{class:"w-3 h-3"})],8,ne)],2))),128)),!w.value[u]||w.value[u].length===0?(l(),i("div",ue," No slots ")):v("",!0)])]))),128))])]),_:1}),t(q,{class:"mt-lg"},{title:o(()=>[t(te,{class:"items-center gap-2"},{default:o(()=>[t(A,{class:"w-5 h-5"}),e[5]||(e[5]=d(" Queue ")),f.queue_items.length>0?(l(),H(I,{key:0,variant:"info"},{default:o(()=>[d(c(f.queue_items.length),1)]),_:1})):v("",!0)]),_:1,__:[5]})]),description:o(()=>e[6]||(e[6]=[d(" Posts waiting to be published based on your schedule. ")])),default:o(()=>[f.queue_items.length>0?(l(),i("div",me,[(l(!0),i(y,null,x(f.queue_items,(s,u)=>{var m,g,S,C,T,$;return l(),i("div",{key:s.id,class:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},[r("div",ce,c(u+1),1),r("div",_e,[r("p",fe,c((($=(T=(C=(S=(g=(m=s.post)==null?void 0:m.versions)==null?void 0:g[0])==null?void 0:S.content)==null?void 0:C[0])==null?void 0:T.body)==null?void 0:$.substring(0,80))||"No content")+"... ",1),r("p",pe,[d(" Scheduled: "+c(s.scheduled_at_formatted||"Pending assignment")+" ",1),s.scheduled_at_relative?(l(),i("span",ye," ("+c(s.scheduled_at_relative)+") ",1)):v("",!0)])]),t(I,{variant:O(s.status)},{default:o(()=>[d(c(s.status),1)]),_:2},1032,["variant"]),r("div",ge,[s.status==="failed"?(l(),i("button",{key:0,onClick:U=>M(s.id),class:"p-1 text-gray-400 hover:text-green-500",title:"Retry"},[t(se,{class:"w-5 h-5"})],8,xe)):v("",!0),r("button",{onClick:U=>D(s.id),class:"p-1 text-gray-400 hover:text-red-500",title:"Remove"},[t(Q,{class:"w-5 h-5"})],8,ve)])])}),128))])):(l(),i("div",he,[t(A,{class:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e[7]||(e[7]=r("p",null,"No posts in queue.",-1)),e[8]||(e[8]=r("p",{class:"text-sm"},"Add posts to your queue from the post editor.",-1))]))]),_:1})])]),t(ee,{show:k.value,onClose:b},{header:o(()=>e[9]||(e[9]=[d(" Add Time Slot ")])),body:o(()=>[r("div",ke,[r("div",null,[t(P,{for:"day"},{default:o(()=>e[10]||(e[10]=[d("Day of Week")])),_:1,__:[10]}),t(Y,{id:"day",modelValue:_(n).day_of_week,"onUpdate:modelValue":e[0]||(e[0]=s=>_(n).day_of_week=s)},{default:o(()=>[(l(!0),i(y,null,x(f.days,(s,u)=>(l(),i("option",{key:u,value:parseInt(u)},c(s),9,be))),128))]),_:1},8,["modelValue"]),t(N,{message:_(n).errors.day_of_week},null,8,["message"])]),r("div",null,[t(P,{for:"time"},{default:o(()=>e[11]||(e[11]=[d("Time")])),_:1,__:[11]}),t(X,{id:"time",type:"time",modelValue:_(n).time,"onUpdate:modelValue":e[1]||(e[1]=s=>_(n).time=s)},null,8,["modelValue"]),t(N,{message:_(n).errors.time},null,8,["message"])])])]),footer:o(()=>[t(J,{onClick:b},{default:o(()=>e[12]||(e[12]=[d("Cancel")])),_:1,__:[12]}),t(V,{onClick:F,disabled:_(n).processing,class:"ml-2"},{default:o(()=>e[13]||(e[13]=[d(" Add Slot ")])),_:1,__:[13]},8,["disabled"])]),_:1},8,["show"])],64))}};export{je as default};
