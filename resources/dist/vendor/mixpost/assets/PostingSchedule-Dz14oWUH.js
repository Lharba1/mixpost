import{r as z,T as L,h as W,c as a,o as l,a as t,b as s,u as _,Z as E,t as m,w as r,F as g,e as y,f as x,n as J,d,P as Z,U as q,g as G,k as H,N as v}from"./app-B17NwYzj.js";import{_ as K}from"./PageHeader-DfBjB2Gc.js";import{_ as A}from"./Panel-BlBCMgbm.js";import{_ as V}from"./PrimaryButton-C9dUpZNY.js";import{_ as X}from"./Input-CCipsDxT.js";import{_ as Y}from"./Select-CI-hx42D.js";import{_ as N}from"./Label-DpRV0xzp.js";import{_ as P}from"./Error-DseFUriH.js";import{a as ee}from"./DialogModal-BYxkMqdg.js";import{_ as te}from"./Flex-BY-wEFr9.js";import{_ as I}from"./Badge-W0WR448u.js";import{T as Q}from"./Trash-BfWq0Mu2.js";import{A as se}from"./ArrowPath-BKMU8m_s.js";import"./PureButton-Cwn7JU-l.js";const oe={class:"row-py mb-2xl w-full mx-auto"},re={class:"row-px"},le={class:"mb-4 p-4 bg-gray-100 dark:bg-gray-800 rounded overflow-auto",style:{"max-height":"200px"}},ae={class:"text-xs mt-2"},ie={class:"grid grid-cols-7 gap-2"},de={class:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2 text-center"},ne={class:"space-y-1 min-h-[60px]"},ue=["onClick"],me=["onClick"],ce={key:0,class:"text-xs text-gray-400 text-center py-2"},fe={key:0,class:"space-y-3"},_e={class:"text-2xl font-bold text-gray-300 dark:text-gray-600 w-8"},ge={class:"flex-1 min-w-0"},pe={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},ye={class:"text-xs text-gray-500 mt-1"},xe={key:0,class:"ml-2 text-gray-400"},ve={class:"flex gap-2"},he=["onClick"],ke=["onClick"],be={key:1,class:"text-center py-8 text-gray-500"},we={class:"space-y-4"},Se=["value"],Oe={__name:"PostingSchedule",props:{schedule:{type:Object,required:!0},queue_items:{type:Array,default:()=>[]},days:{type:Object,required:!0}},setup(c){const h=c,k=z(!1),u=L({day_of_week:1,time:"09:00"}),B=()=>{u.reset(),k.value=!0},b=()=>{k.value=!1,u.reset()},D=()=>{u.post(route("mixpost.schedule.addTimeSlot"),{preserveScroll:!0,onSuccess:()=>{b()}})},F=i=>{confirm("Remove this time slot?")&&v.delete(route("mixpost.schedule.removeTimeSlot",{time:i}),{preserveScroll:!0})},j=i=>{v.put(route("mixpost.schedule.toggleTimeSlot",{time:i}),{},{preserveScroll:!0})},O=i=>{confirm("Remove this post from the queue?")&&v.delete(route("mixpost.schedule.removeFromQueue",{queueItem:i}),{preserveScroll:!0})},R=i=>{v.put(route("mixpost.schedule.retryQueueItem",{queueItem:i}),{},{preserveScroll:!0})},w=W(()=>{if(!h.schedule.times)return{};const i={};for(const[e,o]of Object.entries(h.days))i[e]=h.schedule.times.filter(n=>n.day_of_week===parseInt(e));return i}),M=i=>({pending:"info",processing:"warning",published:"success",failed:"danger"})[i]||"default";return(i,e)=>(l(),a(g,null,[t(_(E),{title:"Posting Schedule"}),s("div",oe,[t(K,{title:"Posting Schedule"}),s("div",re,[s("div",le,[s("details",null,[e[2]||(e[2]=s("summary",{class:"cursor-pointer font-bold"},"Debug Data (Click to expand)",-1)),s("pre",ae,m(JSON.stringify({schedule:c.schedule,days:c.days},null,2)),1)])]),t(A,null,{title:r(()=>e[3]||(e[3]=[d("Weekly Schedule")])),description:r(()=>e[4]||(e[4]=[d(" Set up recurring time slots for automatic post scheduling. ")])),action:r(()=>[t(V,{onClick:B,size:"sm"},{default:r(()=>[t(Z,{class:"w-4 h-4 mr-1"}),e[5]||(e[5]=d(" Add Time Slot "))]),_:1,__:[5]})]),default:r(()=>[s("div",ie,[(l(!0),a(g,null,y(c.days,(o,n)=>(l(),a("div",{key:n,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},[s("h4",de,m(o.substring(0,3)),1),s("div",ne,[(l(!0),a(g,null,y(w.value[n],f=>(l(),a("div",{key:f.id,class:J(["flex items-center justify-between p-1.5 bg-white dark:bg-gray-700 rounded text-xs",{"opacity-50":!f.is_active}])},[s("button",{onClick:p=>j(f.id),class:"font-medium text-gray-700 dark:text-gray-300 hover:text-primary-500"},m(f.formatted_time),9,ue),s("button",{onClick:p=>F(f.id),class:"text-gray-400 hover:text-red-500"},[t(Q,{class:"w-3 h-3"})],8,me)],2))),128)),!w.value[n]||w.value[n].length===0?(l(),a("div",ce," No slots ")):x("",!0)])]))),128))])]),_:1}),t(A,{class:"mt-lg"},{title:r(()=>[t(te,{class:"items-center gap-2"},{default:r(()=>[t(q,{class:"w-5 h-5"}),e[6]||(e[6]=d(" Queue ")),c.queue_items.length>0?(l(),G(I,{key:0,variant:"info"},{default:r(()=>[d(m(c.queue_items.length),1)]),_:1})):x("",!0)]),_:1,__:[6]})]),description:r(()=>e[7]||(e[7]=[d(" Posts waiting to be published based on your schedule. ")])),default:r(()=>[c.queue_items.length>0?(l(),a("div",fe,[(l(!0),a(g,null,y(c.queue_items,(o,n)=>{var f,p,S,C,T,$;return l(),a("div",{key:o.id,class:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},[s("div",_e,m(n+1),1),s("div",ge,[s("p",pe,m((($=(T=(C=(S=(p=(f=o.post)==null?void 0:f.versions)==null?void 0:p[0])==null?void 0:S.content)==null?void 0:C[0])==null?void 0:T.body)==null?void 0:$.substring(0,80))||"No content")+"... ",1),s("p",ye,[d(" Scheduled: "+m(o.scheduled_at_formatted||"Pending assignment")+" ",1),o.scheduled_at_relative?(l(),a("span",xe," ("+m(o.scheduled_at_relative)+") ",1)):x("",!0)])]),t(I,{variant:M(o.status)},{default:r(()=>[d(m(o.status),1)]),_:2},1032,["variant"]),s("div",ve,[o.status==="failed"?(l(),a("button",{key:0,onClick:U=>R(o.id),class:"p-1 text-gray-400 hover:text-green-500",title:"Retry"},[t(se,{class:"w-5 h-5"})],8,he)):x("",!0),s("button",{onClick:U=>O(o.id),class:"p-1 text-gray-400 hover:text-red-500",title:"Remove"},[t(Q,{class:"w-5 h-5"})],8,ke)])])}),128))])):(l(),a("div",be,[t(q,{class:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e[8]||(e[8]=s("p",null,"No posts in queue.",-1)),e[9]||(e[9]=s("p",{class:"text-sm"},"Add posts to your queue from the post editor.",-1))]))]),_:1})])]),t(ee,{show:k.value,onClose:b},{header:r(()=>e[10]||(e[10]=[d(" Add Time Slot ")])),body:r(()=>[s("div",we,[s("div",null,[t(N,{for:"day"},{default:r(()=>e[11]||(e[11]=[d("Day of Week")])),_:1,__:[11]}),t(Y,{id:"day",modelValue:_(u).day_of_week,"onUpdate:modelValue":e[0]||(e[0]=o=>_(u).day_of_week=o)},{default:r(()=>[(l(!0),a(g,null,y(c.days,(o,n)=>(l(),a("option",{key:n,value:parseInt(n)},m(o),9,Se))),128))]),_:1},8,["modelValue"]),t(P,{message:_(u).errors.day_of_week},null,8,["message"])]),s("div",null,[t(N,{for:"time"},{default:r(()=>e[12]||(e[12]=[d("Time")])),_:1,__:[12]}),t(X,{id:"time",type:"time",modelValue:_(u).time,"onUpdate:modelValue":e[1]||(e[1]=o=>_(u).time=o)},null,8,["modelValue"]),t(P,{message:_(u).errors.time},null,8,["message"])])])]),footer:r(()=>[t(H,{onClick:b},{default:r(()=>e[13]||(e[13]=[d("Cancel")])),_:1,__:[13]}),t(V,{onClick:D,disabled:_(u).processing,class:"ml-2"},{default:r(()=>e[14]||(e[14]=[d(" Add Slot ")])),_:1,__:[14]},8,["disabled"])]),_:1},8,["show"])],64))}};export{Oe as default};
