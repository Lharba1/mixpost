import{r as y,s as O,c as l,o,a as n,b as s,w as a,d as i,g as x,F as f,e as p,t as d,k as g,N as b}from"./app-Dm7lxJss.js";import{_ as j}from"./PageHeader-CPXE5HTi.js";import{_ as F}from"./Panel-aOTbxuV2.js";import{_ as v}from"./PrimaryButton-hdLg3DP1.js";import{_ as S}from"./DangerButton-BXQLP50_.js";import{_ as C}from"./Badge-BZMN-Nd9.js";import{a as z}from"./DialogModal-DLnyuNGq.js";import{_ as T}from"./Input-AljN_id1.js";import{_ as B}from"./Checkbox-D79czH5x.js";import{_ as D}from"./NoResult-CLDAt-ch.js";import{_ as E}from"./Alert-Da7IhR_e.js";import"./PureButton-aB4y0syB.js";const M={class:"row-py"},R={key:0,class:"divide-y divide-gray-200 dark:divide-gray-700"},h={class:"flex items-start justify-between"},q={class:"flex items-center gap-2 mb-1"},L={class:"font-medium text-gray-900 dark:text-gray-100"},U={class:"text-sm text-gray-500 font-mono"},J={class:"flex flex-wrap gap-1 mt-2"},K={class:"text-xs text-gray-400 mt-2"},X={key:0},Y={key:1},G={class:"flex items-center gap-2"},H={class:"bg-gray-100 dark:bg-gray-800 p-4 rounded font-mono text-sm break-all"},Q={key:1,class:"space-y-4"},W={class:"space-y-2"},Z={class:"text-sm text-gray-600 dark:text-gray-400"},fe={__name:"ApiTokens",props:{tokens:Array,available_abilities:Object},setup(c){const w=c,k=y(!1),m=y(null),r=O({name:"",abilities:[],expires_at:""}),$=()=>{r.name="",r.abilities=Object.keys(w.available_abilities||{}),r.expires_at=""},A=()=>{$(),m.value=null,k.value=!0},N=async()=>{try{const e=await(await fetch(route("mixpost.apiTokens.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(r)})).json();e.success&&(m.value=e.token,b.reload({only:["tokens"]}))}catch(u){console.error("Failed to create token:",u)}},V=()=>{navigator.clipboard.writeText(m.value),alert("Token copied to clipboard!")},P=u=>{confirm("Delete this API token? This cannot be undone.")&&b.delete(route("mixpost.apiTokens.destroy",u.id))},I=u=>{const e=r.abilities.indexOf(u);e>-1?r.abilities.splice(e,1):r.abilities.push(u)};return(u,e)=>(o(),l("div",null,[n(j,{title:"API Tokens"},{description:a(()=>e[5]||(e[5]=[i(" Manage API tokens for external integrations ")])),_:1}),s("div",M,[n(F,null,{action:a(()=>[n(v,{size:"sm",onClick:A},{default:a(()=>e[6]||(e[6]=[i(" Create Token ")])),_:1,__:[6]})]),default:a(()=>[c.tokens&&c.tokens.length>0?(o(),l("div",R,[(o(!0),l(f,null,p(c.tokens,t=>(o(),l("div",{key:t.id,class:"py-4"},[s("div",h,[s("div",null,[s("div",q,[s("h3",L,d(t.name),1),n(C,{variant:t.is_active?"success":"default",size:"sm"},{default:a(()=>[i(d(t.is_active?"Active":"Revoked"),1)]),_:2},1032,["variant"])]),s("p",U,d(t.masked_token),1),s("div",J,[(o(!0),l(f,null,p(t.abilities,_=>(o(),x(C,{key:_,variant:"info",size:"sm"},{default:a(()=>[i(d(_),1)]),_:2},1024))),128))]),s("p",K,[i(" Created "+d(t.created_at)+" • ",1),t.last_used_at?(o(),l("span",X,"Last used "+d(t.last_used_at),1)):(o(),l("span",Y,"Never used")),i(" • "+d(t.logs_count)+" requests ",1)])]),s("div",G,[n(S,{size:"xs",onClick:_=>P(t)},{default:a(()=>e[7]||(e[7]=[i(" Revoke ")])),_:2,__:[7]},1032,["onClick"])])])]))),128))])):(o(),x(D,{key:1},{default:a(()=>e[8]||(e[8]=[i(" No API tokens. Create one to integrate with external services. ")])),_:1,__:[8]}))]),_:1})]),n(z,{show:k.value,onClose:e[4]||(e[4]=t=>!m.value&&(k.value=!1))},{title:a(()=>[i(d(m.value?"Token Created!":"Create API Token"),1)]),content:a(()=>[m.value?(o(),l(f,{key:0},[n(E,{variant:"warning",class:"mb-4"},{default:a(()=>e[9]||(e[9]=[i(" Copy this token now. You won't be able to see it again! ")])),_:1,__:[9]}),s("div",H,d(m.value),1)],64)):(o(),l("div",Q,[s("div",null,[e[10]||(e[10]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Token Name",-1)),n(T,{modelValue:r.name,"onUpdate:modelValue":e[0]||(e[0]=t=>r.name=t),placeholder:"My Integration",class:"w-full"},null,8,["modelValue"])]),s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Expires At (optional)",-1)),n(T,{modelValue:r.expires_at,"onUpdate:modelValue":e[1]||(e[1]=t=>r.expires_at=t),type:"date",class:"w-full"},null,8,["modelValue"])]),s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Permissions",-1)),s("div",W,[(o(!0),l(f,null,p(c.available_abilities,(t,_)=>(o(),l("div",{key:_,class:"flex items-center gap-2"},[n(B,{checked:r.abilities.includes(_),onChange:ee=>I(_)},null,8,["checked","onChange"]),s("span",Z,d(t),1)]))),128))])])]))]),footer:a(()=>[m.value?(o(),l(f,{key:0},[n(g,{onClick:V},{default:a(()=>e[13]||(e[13]=[i("Copy Token")])),_:1,__:[13]}),n(v,{onClick:e[2]||(e[2]=t=>k.value=!1),class:"ml-2"},{default:a(()=>e[14]||(e[14]=[i("Done")])),_:1,__:[14]})],64)):(o(),l(f,{key:1},[n(g,{onClick:e[3]||(e[3]=t=>k.value=!1)},{default:a(()=>e[15]||(e[15]=[i("Cancel")])),_:1,__:[15]}),n(v,{onClick:N,class:"ml-2"},{default:a(()=>e[16]||(e[16]=[i("Create Token")])),_:1,__:[16]})],64))]),_:1},8,["show"])]))}};export{fe as default};
