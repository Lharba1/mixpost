import{r as Z,T as G,h as H,c as i,o as l,a as s,b as r,u as _,Z as J,w as o,F as y,e as x,t as c,f as v,n as K,d,P as X,U as N,g as Y,k as ee,N as h}from"./app-Bfi9qnSV.js";import{_ as te}from"./PageHeader-kH8NfVLU.js";import{_ as I}from"./Panel-DrNtDh1f.js";import{_ as Q}from"./PrimaryButton-DiebvJzD.js";import{_ as se}from"./Input-DL33O9D5.js";import{_ as oe}from"./Select-DGVk8M1l.js";import{_ as B}from"./Label-PGaXJDCq.js";import{_ as F}from"./Error-nkbr1dlU.js";import{a as re}from"./DialogModal-BXjZ8AL1.js";import{_ as le}from"./Flex-BZSCeI48.js";import{_ as j}from"./Badge-BDC5byay.js";import{T as R}from"./Trash-DI7bD8l7.js";import{A as ae}from"./ArrowPath-DFPzGVqy.js";import"./PureButton-CtlOFdhT.js";const ie={class:"row-py mb-2xl w-full mx-auto"},de={class:"row-px"},ne={class:"grid grid-cols-7 gap-2"},ue={class:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2 text-center"},me={class:"space-y-1 min-h-[60px]"},ce=["onClick"],_e=["onClick"],fe={key:0,class:"text-xs text-gray-400 text-center py-2"},pe={key:0,class:"space-y-3"},ye={class:"text-2xl font-bold text-gray-300 dark:text-gray-600 w-8"},ge={class:"flex-1 min-w-0"},xe={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},ve={class:"text-xs text-gray-500 mt-1"},he={key:0,class:"ml-2 text-gray-400"},ke={class:"flex gap-2"},be=["onClick"],we=["onClick"],Se={key:1,class:"text-center py-8 text-gray-500"},Ce={class:"space-y-4"},Te=["value"],Oe={__name:"PostingSchedule",props:{schedule:{type:Object,required:!0},queue_items:{type:Array,default:()=>[]},days:{type:Object,required:!0}},setup(f){const p=f,k=Z(!1),n=G({day_of_week:1,time:"09:00"}),D=()=>{n.reset(),k.value=!0},b=()=>{k.value=!1,n.reset()},M=()=>{n.post(route("mixpost.schedule.addTimeSlot"),{preserveScroll:!0,onSuccess:()=>{b()}})},O=a=>{confirm("Remove this time slot?")&&h.delete(route("mixpost.schedule.removeTimeSlot",{time:a}),{preserveScroll:!0})},U=a=>{h.put(route("mixpost.schedule.toggleTimeSlot",{time:a}),{},{preserveScroll:!0})},z=a=>{confirm("Remove this post from the queue?")&&h.delete(route("mixpost.schedule.removeFromQueue",{queueItem:a}),{preserveScroll:!0})},L=a=>{h.put(route("mixpost.schedule.retryQueueItem",{queueItem:a}),{},{preserveScroll:!0})},w=H(()=>{let a=[];p.schedule.times&&(Array.isArray(p.schedule.times)?a=p.schedule.times:Array.isArray(p.schedule.times.data)&&(a=p.schedule.times.data));const e={};for(const[t,u]of Object.entries(p.days))e[t]=a.filter(m=>m.day_of_week===parseInt(t));return e}),W=a=>({pending:"info",processing:"warning",published:"success",failed:"danger"})[a]||"default";return(a,e)=>(l(),i(y,null,[s(_(J),{title:"Posting Schedule"}),r("div",ie,[s(te,{title:"Posting Schedule"}),r("div",de,[s(I,null,{title:o(()=>e[2]||(e[2]=[d("Weekly Schedule")])),description:o(()=>e[3]||(e[3]=[d(" Set up recurring time slots for automatic post scheduling. ")])),action:o(()=>[s(Q,{onClick:D,size:"sm"},{default:o(()=>[s(X,{class:"w-4 h-4 mr-1"}),e[4]||(e[4]=d(" Add Time Slot "))]),_:1,__:[4]})]),default:o(()=>[r("div",ne,[(l(!0),i(y,null,x(f.days,(t,u)=>(l(),i("div",{key:u,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},[r("h4",ue,c(t.substring(0,3)),1),r("div",me,[(l(!0),i(y,null,x(w.value[u],m=>(l(),i("div",{key:m.id,class:K(["flex items-center justify-between p-1.5 bg-white dark:bg-gray-700 rounded text-xs",{"opacity-50":!m.is_active}])},[r("button",{onClick:g=>U(m.id),class:"font-medium text-gray-700 dark:text-gray-300 hover:text-primary-500"},c(m.formatted_time),9,ce),r("button",{onClick:g=>O(m.id),class:"text-gray-400 hover:text-red-500"},[s(R,{class:"w-3 h-3"})],8,_e)],2))),128)),!w.value[u]||w.value[u].length===0?(l(),i("div",fe," No slots ")):v("",!0)])]))),128))])]),_:1}),s(I,{class:"mt-lg"},{title:o(()=>[s(le,{class:"items-center gap-2"},{default:o(()=>[s(N,{class:"w-5 h-5"}),e[5]||(e[5]=d(" Queue ")),f.queue_items.length>0?(l(),Y(j,{key:0,variant:"info"},{default:o(()=>[d(c(f.queue_items.length),1)]),_:1})):v("",!0)]),_:1,__:[5]})]),description:o(()=>e[6]||(e[6]=[d(" Posts waiting to be published based on your schedule. ")])),default:o(()=>[f.queue_items.length>0?(l(),i("div",pe,[(l(!0),i(y,null,x(f.queue_items,(t,u)=>{var m,g,S,C,T,$,A,q,V,P;return l(),i("div",{key:t.id,class:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},[r("div",ye,c(u+1),1),r("div",ge,[r("p",xe,c(((T=(C=(S=(g=(m=t.post)==null?void 0:m.versions)==null?void 0:g[0])==null?void 0:S.content)==null?void 0:C[0])==null?void 0:T.excerpt)||((P=(V=(q=(A=($=t.post)==null?void 0:$.versions)==null?void 0:A[0])==null?void 0:q.content)==null?void 0:V[0])==null?void 0:P.body)||"No content"),1),r("p",ve,[d(" Scheduled: "+c(t.scheduled_at_formatted||"Pending assignment")+" ",1),t.scheduled_at_relative?(l(),i("span",he," ("+c(t.scheduled_at_relative)+") ",1)):v("",!0)])]),s(j,{variant:W(t.status)},{default:o(()=>[d(c(t.status),1)]),_:2},1032,["variant"]),r("div",ke,[t.status==="failed"?(l(),i("button",{key:0,onClick:E=>L(t.id),class:"p-1 text-gray-400 hover:text-green-500",title:"Retry"},[s(ae,{class:"w-5 h-5"})],8,be)):v("",!0),r("button",{onClick:E=>z(t.id),class:"p-1 text-gray-400 hover:text-red-500",title:"Remove"},[s(R,{class:"w-5 h-5"})],8,we)])])}),128))])):(l(),i("div",Se,[s(N,{class:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e[7]||(e[7]=r("p",null,"No posts in queue.",-1)),e[8]||(e[8]=r("p",{class:"text-sm"},"Add posts to your queue from the post editor.",-1))]))]),_:1})])]),s(re,{show:k.value,onClose:b},{header:o(()=>e[9]||(e[9]=[d(" Add Time Slot ")])),body:o(()=>[r("div",Ce,[r("div",null,[s(B,{for:"day"},{default:o(()=>e[10]||(e[10]=[d("Day of Week")])),_:1,__:[10]}),s(oe,{id:"day",modelValue:_(n).day_of_week,"onUpdate:modelValue":e[0]||(e[0]=t=>_(n).day_of_week=t)},{default:o(()=>[(l(!0),i(y,null,x(f.days,(t,u)=>(l(),i("option",{key:u,value:parseInt(u)},c(t),9,Te))),128))]),_:1},8,["modelValue"]),s(F,{message:_(n).errors.day_of_week},null,8,["message"])]),r("div",null,[s(B,{for:"time"},{default:o(()=>e[11]||(e[11]=[d("Time")])),_:1,__:[11]}),s(se,{id:"time",type:"time",modelValue:_(n).time,"onUpdate:modelValue":e[1]||(e[1]=t=>_(n).time=t)},null,8,["modelValue"]),s(F,{message:_(n).errors.time},null,8,["message"])])])]),footer:o(()=>[s(ee,{onClick:b},{default:o(()=>e[12]||(e[12]=[d("Cancel")])),_:1,__:[12]}),s(Q,{onClick:M,disabled:_(n).processing,class:"ml-2"},{default:o(()=>e[13]||(e[13]=[d(" Add Slot ")])),_:1,__:[13]},8,["disabled"])]),_:1},8,["show"])],64))}};export{Oe as default};
